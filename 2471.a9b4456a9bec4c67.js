"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2471],{2471:(U,g,t)=>{t.r(g),t.d(g,{MoviesPage:()=>S});var u=t(5861),c=t(6895),f=t(433),n=t(7002),m=t(2340),d=t(1407),h=t(7579),p=t(4482),M=t(5403),Z=t(8421),T=t(5032);function v(s){return(0,p.e)((a,i)=>{(0,Z.Xf)(s).subscribe((0,M.x)(i,()=>i.complete(),T.Z)),!i.closed&&a.subscribe(i)})}var e=t(8256),y=t(2208);const I=function(s){return[s]};function P(s,a){if(1&s&&(e.TgZ(0,"ion-item",4)(1,"ion-avatar",5),e._UZ(2,"img",6),e.qZA(),e.TgZ(3,"ion-label"),e._uU(4),e.TgZ(5,"p"),e._uU(6),e.ALo(7,"date"),e.qZA()(),e.TgZ(8,"ion-badge",7),e._uU(9),e.qZA()()),2&s){const i=a.$implicit,o=e.oxw();e.Q6J("routerLink",e.VKq(8,I,i.id)),e.xp6(2),e.Q6J("src",o.imageBaseUrl+"/w92"+i.poster_path,e.LSH),e.xp6(2),e.hij(" ",i.title," "),e.xp6(2),e.Oqu(e.xi3(7,5,i.release_date,"y")),e.xp6(3),e.hij(" ",i.vote_average," ")}}function x(s,a){if(1&s){const i=e.EpF();e.TgZ(0,"ion-infinite-scroll",8),e.NdJ("ionInfinite",function(l){e.CHM(i);const r=e.oxw();return e.KtG(r.loadMore(l))}),e._UZ(1,"ion-infinite-scroll-content",9),e.qZA()}}let S=(()=>{class s{constructor(i,o){this.movieService=i,this.loadingCtrl=o,this.movies=[],this.filteredMovies=[],this.isSearching=!1,this.currentPage=1,this.imageBaseUrl=m.N.images,this.destroyed$=new h.x}ngOnInit(){this.loadMovies()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}loadMovies(i){var o=this;return(0,u.Z)(function*(){const l=yield o.loadingCtrl.create({message:"Loading...",spinner:"bubbles"});yield l.present(),o.movieService.getTopRatedMovies(o.currentPage).pipe(v(o.destroyed$)).subscribe(r=>{l.dismiss(),o.movies.push(...r.results),console.log(r),null==i||i.target.complete(),i&&(i.target.disabled=r.total_pages===o.currentPage)})})()}handleInput(i){const o=i.target.value;o?this.movieService.searchMovie(o).pipe(v(this.destroyed$)).subscribe(l=>{this.isSearching=!0,this.filteredMovies=l.results.sort((r,b)=>b.vote_average-r.vote_average)}):this.isSearching=!1}loadMore(i){this.currentPage++,this.loadMovies(i)}}return s.\u0275fac=function(i){return new(i||s)(e.Y36(y.u),e.Y36(n.HT))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-movies"]],standalone:!0,features:[e.jDz],decls:10,vars:3,consts:[["color","primary"],["placeholder","Title",3,"debounce","ionInput"],["button","",3,"routerLink",4,"ngFor","ngForOf"],[3,"ionInfinite",4,"ngIf"],["button","",3,"routerLink"],["slot","start"],[3,"src"],["slot","end"],[3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Loading more movies..."]],template:function(i,o){1&i&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3,"Trending movies"),e.qZA()(),e.TgZ(4,"ion-toolbar")(5,"ion-searchbar",1),e.NdJ("ionInput",function(r){return o.handleInput(r)}),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-list"),e.YNc(8,P,10,10,"ion-item",2),e.qZA(),e.YNc(9,x,2,0,"ion-infinite-scroll",3),e.qZA()),2&i&&(e.xp6(5),e.Q6J("debounce",1e3),e.xp6(3),e.Q6J("ngForOf",o.isSearching?o.filteredMovies:o.movies),e.xp6(1),e.Q6J("ngIf",!o.isSearching))},dependencies:[n.Pc,n.BJ,n.yp,n.W2,n.Gu,n.ju,n.MB,n.Ie,n.Q$,n.q_,n.VI,n.wd,n.sr,n.j9,n.YI,c.ez,c.sg,c.O5,c.uU,f.u5,d.Bz,d.rH]}),s})()}}]);